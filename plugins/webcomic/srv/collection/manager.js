!function(){"use strict";!function t(){if("loading"===document.readyState)return document.addEventListener("DOMContentLoaded",t);function v(t,e,a){var n=document.querySelector('[name="'.concat(t.getAttribute("data-input"),'"]')),i=new FormData,c=new XMLHttpRequest,o=n.value.split(",");n.value=e.toString(),o.toString()!==e.toString()&&n.dispatchEvent(new Event("change",{bubbles:!0})),i.append("action","webcomic_update_media_manager"),i.append("media",e),c.onreadystatechange=function(){4===c.readyState&&(e=e.map(function(t){return parseInt(t)}),function(c,n,o,t){c.innerHTML="";for(var e=0;e<t.length;e++)c.innerHTML+=(a=t[e].id,i=t[e].media,'\n\t\t\t<div data-id="'.concat(a,'">\n\t\t\t\t').concat(i,'\n\t\t\t\t<a class="dashicons dashicons-no" style="cursor:pointer">\n\t\t\t\t\t<span class="screen-reader-text">').concat(webcomicMediaManagerL10n.remove,"</span>\n\t\t\t\t</a>\n\t\t\t</div>"));var a,i;c.innerHTML+=(u=t,s=o,l="dashicons-format-image",m=webcomicMediaManagerL10n.add,p="",s&&(l="dashicons-images-alt2"),u.length&&(m=webcomicMediaManagerL10n.change),p='\n\t\t\t<p>\n\t\t\t\t<button type="button" class="button button-large">\n\t\t\t\t\t<span class="dashicons '.concat(l,'"></span> ').concat(m,"\n\t\t\t\t</button>\n\t\t\t</p>"),1<u.length&&s&&(p+='<p class="description">'.concat(webcomicMediaManagerL10n.drag,"</p>")),p),o&&(r=c,d=o,jQuery(r).sortable({items:"div",start:function(t,e){e.placeholder.height(e.helper.outerHeight())},stop:function(){v(r,jQuery(r).sortable("toArray",{attribute:"data-id"}),d)}}));var r,d;var u,s,l,m,p;c.querySelector("button").addEventListener("click",function(){var n,i;n=c,i=o,wp.media.frames.webcomicMedia=wp.media({title:webcomicMediaManagerL10n.title,button:{text:webcomicMediaManagerL10n.update},library:{type:"image"},multiple:i}).on("select",function(){for(var t=[],e=wp.media.frames.webcomicMedia.state().get("selection"),a=0;a<e.length;a++)t.push(e.models[a].id);v(n,t,i)}).open()});for(var g=c.querySelectorAll("a"),b=function(a){g[a].addEventListener("click",function(t){t.preventDefault();var e=n.indexOf(Number(g[a].parentNode.getAttribute("data-id")));n.splice(e,1),v(c,n,o)})},f=0;f<g.length;f++)b(f)}(t,e,a,JSON.parse(c.responseText)))},c.open("POST",ajaxurl),c.send(i)}!function(t){for(var e=0;e<t.length;e++)v(t[e],document.querySelector('[name="'.concat(t[e].getAttribute("data-input"),'"]')).value.split(","),Boolean(t[e].getAttribute("data-webcomic-media-manager")))}(document.querySelectorAll("[data-webcomic-media-manager]")),jQuery(document).on("widget-added widget-updated",function(t,e){if(!e[0].id.match(/_mgsisk_webcomic_/))return;for(var a=e[0].querySelectorAll("[data-webcomic-media-manager]"),n=0;n<a.length;n++)v(a[n],document.querySelector('[name="'.concat(a[n].getAttribute("data-input"),'"]')).value.split(","),Boolean(a[n].getAttribute("data-webcomic-media-manager")))})}()}();
